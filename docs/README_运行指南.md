# 车牌违停管理系统 - 运行指南

## 🎯 系统简介
车牌违停管理系统是一个功能完整的Web应用，用于记录、查询和管理车辆违停信息。系统支持图片上传、自动压缩、数据统计等功能。

## 🚀 快速启动

### 方法一：使用批处理文件（推荐）
双击运行 `启动系统.bat` 文件，按照提示选择启动方式。

### 方法二：命令行启动
```bash
# 1. 进入项目目录
cd "c:\Users\bairi\Desktop\车牌"

# 2. 运行系统测试（可选）
python test_system.py

# 3. 启动应用
python start_server.py
```

### 方法三：直接运行主程序
```bash
python app.py
```

## 🌐 访问地址
启动成功后，在浏览器中访问：
- **本地访问**: http://127.0.0.1:8080
- **如果端口冲突**: 系统会自动尝试其他端口

## 📱 主要功能

### 1. 违停录入 (`/record`)
- 输入车牌号（自动验证格式）
- 选择违停地点和类型
- 上传现场照片（自动压缩）
- 添加描述信息

### 2. 车辆管理 (`/`)
- 查看所有车辆列表
- 显示违规次数和最后违规时间
- 点击车牌查看详细记录

### 3. 车牌详情 (`/license_plate/<车牌号>`)
- 查看指定车辆的所有违规记录
- 显示违规时间、地点、类型等信息
- 查看上传的照片

## 🔧 系统要求

### 软件环境
- Python 3.7+
- Windows/Linux/macOS

### 依赖包
系统已包含 `requirements.txt`，包含以下依赖：
- Flask==2.3.3
- Werkzeug==2.3.7
- pyopenssl
- Pillow==10.0.1

### 安装依赖
```bash
pip install -r requirements.txt
```

## 📊 数据管理

### 数据库位置
- 数据库文件: `data/violations.db`
- 备份建议: 定期复制此文件

### 数据统计
当前系统数据：
- 车辆总数: 21辆
- 违规记录: 37条
- 支持的数据: 车牌、地点、类型、照片、时间等

## 🛠️ 故障排除

### 问题1：端口被占用
**现象**: "以一种访问权限不允许的方式做了一个访问套接字的尝试"
**解决**: 
1. 修改 `app.py` 中的端口号（改为8081、9000等）
2. 或者关闭占用端口的程序

### 问题2：依赖包缺失
**现象**: "ModuleNotFoundError: No module named 'xxx'"
**解决**: 
```bash
pip install -r requirements.txt
```

### 问题3：权限问题
**现象**: 无法启动服务器
**解决**: 
1. 以管理员身份运行命令提示符
2. 或者使用更高的端口号（如9000）

### 问题4：图片上传失败
**现象**: 图片无法上传或处理
**解决**: 
1. 检查 `uploads/` 目录是否存在
2. 确保Pillow包正确安装
3. 检查图片格式是否支持

## 📞 技术支持

### 系统测试
运行以下命令检查系统状态：
```bash
python test_system.py
```

### 查看日志
系统运行时的错误信息会显示在控制台中。

### API接口
系统提供RESTful API：
- `GET /api/vehicles` - 获取车辆列表
- `GET /api/violations` - 获取违规记录
- `GET /health` - 健康检查

## 📁 文件说明

### 核心文件
- `app.py` - 主应用文件
- `start_server.py` - 启动脚本
- `test_system.py` - 系统测试
- `启动系统.bat` - Windows批处理启动文件

### 配置文件
- `requirements.txt` - Python依赖包
- `SYSTEM_STATUS.md` - 系统状态报告

### 目录结构
- `templates/` - HTML模板文件
- `uploads/` - 上传的图片文件
- `data/` - 数据库文件

## 🔒 安全特性

1. **输入验证**: 严格的车牌号格式验证
2. **文件安全**: 上传文件类型和大小限制
3. **SQL防护**: 参数化查询防止注入攻击
4. **XSS防护**: 输出内容转义
5. **安全头**: HTTP安全头设置

## 📈 性能优化

1. **图片压缩**: 自动压缩上传的图片
2. **数据库索引**: 优化查询性能
3. **缓存机制**: 模板缓存提升响应速度

## 🔄 更新维护

### 数据备份
定期备份 `data/violations.db` 文件

### 版本更新
1. 备份数据
2. 更新代码文件
3. 运行测试验证
4. 重启应用

---

**系统版本**: v1.4  
**最后更新**: 2025-11-20  
**运行状态**: ✅ 正常